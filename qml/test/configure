#!/bin/bash

if [ ! -e ./mocml ]
then
    echo "Building generator"
    cd ../../src
    ./configure
    ocamlbuild mocml/mocml.native
    if [ $? != 0 ]; then
      exit 0
    fi
    cd -
    echo "Adding symlink"
    ln -s ../../src/mocml.native mocml
fi
echo "Executing generator"
PARAMS=""
#PARAMS="$PARAMS -with-debug"
#PARAMS="$PARAMS -with-debug-criticals"
./mocml -qml_wrap input.json $PARAMS
echo ""> .depend
make depend

