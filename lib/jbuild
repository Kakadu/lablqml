(copy_files stubs/*.cpp)

(library
 ((name            lablqml)
  (modules         (lablqml))
  (cxx_names       (CamlPropertyMap_stubs
                    object_ml
                    QSingleFunc_stubs
                    stubs
                    variant
                    modelindex
                    propMap_stubs
                    startup_stubs
                    test_stubs
                   ))
  ; dirty hack next line
  (cxx_flags           ( (:include c_flags.sexp) -O3 -I ../../stubs -Dprivate=public) )
  ;(c_library_flags     (:include c_library_flags.sexp) )
))

(rule
 ((targets (c_flags.sexp
            c_library_flags.sexp))
  (deps    (config/discover.exe))
  (action  (run ${<} -ocamlc ${OCAMLC}))))
